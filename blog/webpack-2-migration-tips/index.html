<!doctype html><html lang="en"><head><title>Webpack 2 Migration Tips | Bobrov Blog</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="Stable version of webpack 2 has been just rleased, there are few tips to help migrate to newest version."><meta name="viewport" content="width=device-width,initial-scale=1,minimal-ui"><meta name="msapplication-tap-highlight" content="no"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="Bobrov Blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Bobrov Blog"><meta name="msapplication-TileColor" content="#00bcd4"><link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon.png"><link rel="icon" type="image/png" href="/images/icons/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/images/icons/favicon-16x16.png" sizes="16x16"><meta name="theme-color" content="#00bcd4"><link rel="dns-prefetch" href="//google-analytics.com"><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//bobrov-blog.disqus.com"><link rel="manifest" href="/manifest.json"><meta property="fb:app_id" content="393821434298248"><meta property="article:author" content="https://www.facebook.com/bobrov1989"><meta property="og:url" content="https://vitaliy-bobrov.github.io/blog/webpack-2-migration-tips/"><meta property="og:type" content="article"><meta property="og:title" content="Webpack 2 Migration Tips"><meta property="og:description" content="Stable version of webpack 2 has been just rleased, there are few tips to help migrate to newest version."><meta property="og:image" content="https://vitaliy-bobrov.github.io/images/posts/webpack-2-migration-tips/webpack-2-migration-tips-og.jpg"><meta property="og:image:url" content="https://vitaliy-bobrov.github.io/images/posts/webpack-2-migration-tips/webpack-2-migration-tips-og.jpg"><meta property="og:image:type" content="image/jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><link rel="stylesheet" href="/css/styles.css"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@bobrov1989"><meta name="twitter:title" content="Webpack 2 Migration Tips"><meta name="twitter:description" content="Stable version of webpack 2 has been just rleased, there are few tips to help migrate to newest version."><meta name="twitter:image:alt" content="Webpack 2 Migration Tips"></head><body class="mdlext-dark-color-theme"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0" height="0" style="position:absolute"><defs><svg viewbox="0 0 24 24" id="arrow-back"><path fill="none" d="M0 0h24v24H0z"/><path d="M20 11H7.8l5.6-5.6L12 4l-8 8 8 8 1.4-1.4L7.8 13H20v-2z"/></svg> <svg viewbox="0 0 24 24" id="comment"><path d="M22 4c0-1-1-2-2-2H4C3 2 2 3 2 4v12c0 1 1 2 2 2h14l4 4V4zm-4 10H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/><path fill="none" d="M0 0h24v24H0z"/></svg> <svg viewbox="0 0 24 24" id="expand-less"><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/></svg> <svg viewbox="0 0 96.1 96.1" id="facebook"><path d="M72 0H59.7c-14 0-23 9.3-23 23.7v11H24c-1 0-2 .7-2 1.8v15.8c0 1 1 2 2 2h12.6v40c0 1 .8 1.8 2 1.8h16.3c1 0 1.8-.8 1.8-1.8v-40h14.7c1 0 2-.8 2-2V36.6c0-.5-.2-1-.6-1.4-.5-.2-1-.4-1.5-.4H56.8v-9.3c0-4.4 1-6.7 7-6.7H72c1.2 0 2-1 2-2V2c0-1-.8-2-2-2z"/></svg> <svg viewbox="0 0 478.6 478.6" id="github"><path d="M427.5 200.7c1.8-11.2 3-23.6 3.2-37.4 0-59.2-28.5-80.2-34-90 8-45-1.3-65.3-5.6-72.3-16-5.7-56 14.7-77 29-36-10.2-111-9.2-139 3C123-4.4 95.6 1.3 95.6 1.3s-18 31.7-5 78.3c-17 21.8-29.7 37.2-29.7 78 0 9.8 0 19 1 28C77 262.8 138 296.2 198 302c-9 6.3-19.7 19.3-21.2 35-11.4 7-34.3 9.2-52 4-25-8-34.6-57.7-72-50-8 1-6.4 6.2.6 11 11.3 7 22 16.3 30.2 36 6.2 15 19.5 42 62 42 16.5 0 28.2-2 28.2-2l.3 53.3c0 17.3-23 22-23 30.4 0 3.3 7.7 3.6 13.8 3.6 12.4 0 37.8-10.2 37.8-28V367c0-18.2 10-24 10-24s1 97.7-2.4 110.8c-4.2 15.3-12 13-12 20 0 10.2 30.8 2.5 41-20 8-17 4.5-112.8 4.5-112.8l8.2-.2s0 44-.3 64c-.3 20.7-2.4 47 10 59.3 8 8 32.8 23 32.8 10 0-7.5-17.4-14-17.4-34.3V345c10.6 0 12.8 31 12.8 31l3.8 57.7s-2.5 21 22.7 30c9 3 28 4 29-1.4 1-5.2-23-13-23-29.3 0-10 .5-16 .5-59s-5.7-59-26-72c58.7-6 119.5-32.2 130.5-101z"/></svg> <svg viewbox="0 0 24 24" id="menu"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg> <svg viewbox="0 0 24 24" id="share"><path fill="none" d="M0 0h24v24H0z"/><path d="M18 16c-.8 0-1.4.4-2 .8l-7-4v-1.5l7-4c.5.4 1.2.7 2 .7 1.7 0 3-1.3 3-3s-1.3-3-3-3-3 1.3-3 3v.7l-7 4C7.5 9.4 6.8 9 6 9c-1.7 0-3 1.3-3 3s1.3 3 3 3c.8 0 1.5-.3 2-.8l7.2 4.2v.6c0 1.6 1.2 3 2.8 3 1.6 0 3-1.4 3-3s-1.4-3-3-3z"/></svg> <svg viewbox="0 0 612 612" id="twitter"><path d="M612 116.3c-22.5 10-46.7 16.7-72 19.7 25.8-15.5 45.7-40 55-69.4C571 81 544 91.4 515.4 97c-23-24.3-55.5-39.6-91.6-39.6C354.4 57.4 298 113.7 298 183c0 9.8 1.2 19.4 3.4 28.6C197 206.3 104.6 156.3 42.6 80.4c-10.8 18.5-17 40-17 63 0 43.6 22.2 82 56 104.6-20.7-.7-40-6.4-57-15.8v1.6c0 60.8 43.3 111.5 100.7 123-10.5 3-21.6 4.5-33 4.5-8.2 0-16-.8-23.7-2.4 16 50 62.3 86 117.3 87-43 34-97.4 54-156 54-10.3 0-20.3-.7-30-1.8C55.5 534 121.4 555 192.3 555c231 0 357.2-191.4 357.2-357.3l-.4-16.3c24.7-17.5 46-39.6 62.8-64.7z"/></svg></defs></svg><div class="mdl-layout mdl-layout--no-desktop-drawer-button mdl-layout--fixed-header mdl-js-layout"><header class="mdl-layout__header" role="banner"><div class="mdl-layout__header-row"><span class="mdl-layout-title"><a href="/" class="site-link">Bobrov Blog</a></span><div class="mdl-layout-spacer"><a href="/" class="site-logo" title="Bobrov Blog"><picture class="site-logo__picture"><source media="(min-width: 1025px)" srcset="/images/logo.webp, /images/logo@2x.webp 2x" type="image/webp"><source media="(min-width: 1025px)" srcset="/images/logo.png, /images/logo@2x.png 2x"><source media="(min-width: 768px)" srcset="/images/logo-tablet.webp, /images/logo-tablet@2x.webp 2x" type="image/webp"><source media="(min-width: 768px)" srcset="/images/logo-tablet.png, /images/logo-tablet@2x.png 2x"><source srcset="/images/logo-mobile.webp, /images/logo-mobile@2x.webp 2x" type="image/webp"><source srcset="/images/logo-mobile.png, /images/logo-mobile@2x.png 2x"><img src="/images/logo.png" alt="Bobrov Blog Logo" class="site-logo__img"></picture></a></div><nav class="mdl-navigation mdl-layout--large-screen-only"><a class="mdl-navigation__link" href="/">Blog</a> <a class="mdl-navigation__link" href="/about/">About</a></nav></div></header><div class="mdl-layout__drawer"><span class="mdl-layout-title">Bobrov Blog</span><nav class="mdl-navigation"><a class="mdl-navigation__link" href="/">Blog</a> <a class="mdl-navigation__link" href="/about/">About</a></nav></div><main class="mdl-layout__content js-to-top-container"><section class="mdl-grid posts-grid"><article class="mdl-card mdl-shadow--3dp mdl-cell post mdl-cell--12-col"><header class="mdl-card__media post__media"><picture class="safe-picture"><source media="(min-width: 1025px)" srcset="/images/posts/webpack-2-migration-tips/webpack-2-migration-tips.webp, /images/posts/webpack-2-migration-tips/webpack-2-migration-tips@2x.webp 2x" type="image/webp"><source media="(min-width: 1025px)" srcset="/images/posts/webpack-2-migration-tips/webpack-2-migration-tips.jpg, /images/posts/webpack-2-migration-tips/webpack-2-migration-tips@2x.jpg 2x"><source media="(min-width: 768px)" srcset="/images/posts/webpack-2-migration-tips/webpack-2-migration-tips-tablet.webp, /images/posts/webpack-2-migration-tips/webpack-2-migration-tips-tablet@2x.webp 2x" type="image/webp"><source media="(min-width: 768px)" srcset="/images/posts/webpack-2-migration-tips/webpack-2-migration-tips-tablet.jpg, /images/posts/webpack-2-migration-tips/webpack-2-migration-tips-tablet@2x.jpg 2x"><source srcset="/images/posts/webpack-2-migration-tips/webpack-2-migration-tips-mobile.webp, /images/posts/webpack-2-migration-tips/webpack-2-migration-tips-mobile@2x.webp 2x" type="image/webp"><source srcset="/images/posts/webpack-2-migration-tips/webpack-2-migration-tips-mobile.jpg, /images/posts/webpack-2-migration-tips/webpack-2-migration-tips-mobile@2x.jpg 2x"><img src="/images/posts/webpack-2-migration-tips/webpack-2-migration-tips.jpg" alt="Webpack 2 Migration Tips" class="safe-picture__img"></picture><div class="safe-gradient"></div><h1 class="post__title">Webpack 2 Migration Tips</h1></header><section class="post__info post-info"><div class="post-info__data"><picture class="post-info__avatar"><source srcset="/images/authors/bobrov/avatar.webp, /images/authors/bobrov/avatar@2x.webp 2x" type="image/webp"><source srcset="/images/authors/bobrov/avatar.jpg, /images/authors/bobrov/avatar@2x.jpg 2x"><img src="/images/authors/bobrov/avatar.jpg" alt="Vitaliy Bobrov Photo" class="mdl-list__item-avatar"></picture><div class="post-info__data-wrapper"><div class="post-info__author">Vitaliy Bobrov</div><time date-time="2017-01-23T01:00:00+01:00" class="post-info__date">23 January 2017</time></div></div><div class="post-info__side"><div class="post-info__categories"><span class="mdl-chip post-info__category"><span class="mdl-chip__text">Tools</span></span></div></div></section><div class="mdl-card__menu post-share"><button id="share-menu-[object Object]" class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect post-share__button" title="Share this post"><svg class="mdl-svg post-share__icon"><use xlink:href="#share"/></svg></button><ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect share-menu" for="share-menu-[object Object]"><li class="mdl-menu__item share-menu__item"><a href="//twitter.com/home?status=https://vitaliy-bobrov.github.io/blog/webpack-2-migration-tips" class="share-menu__link" target="_blank" rel="nofollow"><svg class="share-menu__icon"><use xlink:href="#twitter"/></svg> Twitter</a></li><li class="mdl-menu__item share-menu__item"><a href="//www.facebook.com/sharer.php?u=https://vitaliy-bobrov.github.io/blog/webpack-2-migration-tips" class="share-menu__link" target="_blank" rel="nofollow"><svg class="share-menu__icon"><use xlink:href="#facebook"/></svg> Facebook</a></li></ul></div><section class="post__contents"><p>Webpack 2 has been just released, it brings a lot of improvement and cool features, as well as breaking changes in configuration. Not all issues are easy to find by googling, to solve it fast. That is why I want to share tips that might help you to update you Webpack configuration and don’t broke your bundle.</p><p>First of all, you need to check all new and more user-friendly <a href="https://webpack.js.org/configuration/" target="_blank" rel="nofollow noreferrer noopener">documentation</a>. It is not full now, but anyway, this is the official guide and will be handy.</p><h2>Remove deprecated custom webpack options</h2><p>So let’s start, the first issue that will break your build – exception related to custom properties in your config object. Now properties are limited to allowed list and checked by Webpack. Not all “loaders” allow configuration with new <code>options</code> parameter, for such Webpack loaders you should use <code>LoaderOptionsPlugin</code> until they will be up-to-date with new rules. From my experience, this was related to <code>sass</code> loader. Here is the example:</p><pre><code class="language-js lang-js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

...
plugins: [
  <span class="hljs-keyword">new</span> webpack.LoaderOptionsPlugin({
    sassLoader: {
      includePaths: [path.resolve(__dirname, <span class="hljs-string">"./mdl"</span>)],
      precision: <span class="hljs-number">10</span>
    },
    context: __dirname
  })
]
</code></pre><p>You might mention that I’ve also added context option, it is not a mistake. This was necessary to pass context to got sass non-relative imports like <code class="lang-js">@<span class="hljs-keyword">import</span> <span class="hljs-string">'~mdl/component'</span></code> working.</p><h2>Configure Babel</h2><p>If you are using Babel to transpile your code to ES5, there are a good news for you, from the 2nd version Webpack supports native imports. So you don’t need to transform such statements as <code class="lang-js"><span class="hljs-keyword">import</span> moment <span class="hljs-keyword">from</span> <span class="hljs-string">'moment'</span></code> to CommonJS modules, Webpack normally handles this. To configure Babel properly just add option to preset <code>es2015</code> in your <code class="lang-css"><span class="hljs-class">.babelrc</span></code> file:</p><pre><code class="language-json lang-js"><span class="hljs-string">"presets"</span>: [
  [<span class="hljs-string">"es2015"</span>, { <span class="hljs-string">"modules"</span>: <span class="hljs-literal">false</span> }]
]
</code></pre><p>This will enable usual <code>preset-es2015</code> with the disabled native module to CommonJS transform.</p><h2>Rename configuration properties</h2><p>In new Webpack, some of the properties were renamed. You should rename your <code class="lang-js"><span class="hljs-built_in">module</span>.loaders</code> to <code class="lang-js"><span class="hljs-built_in">module</span>.rules</code> and inside each rule change <code>loader</code> property to <code>use</code> array, like this:</p><pre><code class="language-js lang-css">...
<span class="hljs-tag">module</span>: <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">rules</span>:<span class="hljs-value"> [
    {
      test: /\.ts$/,
      use: [
        <span class="hljs-string">'typescript-loader'</span>
      ]
    </span></span></span>}
  ]
</code></pre><h2>Change ugly loaders chain</h2><p>From now old-style short syntax for loaders definition is deprecated, you should use an array of strings/objects instead. Also, auto loader resolve in disabled by default, prefer to write full loader name. Example of transformed loader:</p><pre><code class="lang-js"><span class="hljs-string">'style!css?sourceMap!postcss!sass?sourceMap'</span>
</code></pre><pre><code class="language-js lang-css"><span class="hljs-tag">module</span>: <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">rules</span>:<span class="hljs-value"> [
    {
      test: /\.(scss|sass)$/,
      use: [
        <span class="hljs-string">'style-loader'</span>,
        {
          loader: <span class="hljs-string">'css-loader'</span>,
          options: {
            sourceMap: true
          </span></span></span>}
        },
        <span class="hljs-rules">{
          <span class="hljs-rule"><span class="hljs-attribute">loader</span>:<span class="hljs-value"> <span class="hljs-string">'postcss-loader'</span>
        </span></span></span>},
        <span class="hljs-rules">{
          <span class="hljs-rule"><span class="hljs-attribute">loader</span>:<span class="hljs-value"> <span class="hljs-string">'sass-loader'</span>,
          options: {
            sourceMap: true
          </span></span></span>}
        }
      ]
    }
  ]
}
</code></pre><p>Here you can also mention that if loader has no options, it could be declared as a simple string instead object with <code>loader</code> key.</p><h2>Extract Text Plugin</h2><p>When this post was written <code>ExtractTextPlugin</code> hasn’t stable release for Webpack 2, that is why you need to specify the latest version of the v2 branch while installation:</p><pre><code class="language-bash lang-css"><span class="hljs-tag">npm</span> <span class="hljs-tag">install</span> <span class="hljs-tag">extract-text-webpack-plugin</span><span class="hljs-at_rule">@<span class="hljs-keyword">2.0.0-beta.5</span>
</span></code></pre><p>Also in my configuration it won’t to work with CSS preprocessor, the solution was to change config:</p><pre><code class="language-js lang-js"><span class="hljs-built_in">module</span>: {
  rules: [
    {
      test: <span class="hljs-regexp">/\.(scss|sass)$/</span>,
      use: [
        ExtractTextPlugin.extract({
          fallbackLoader: <span class="hljs-string">'style-loader'</span>,
          loader: <span class="hljs-string">'style-loader'</span>
        }),
        {
          loader: <span class="hljs-string">'css-loader'</span>,
          options: {
            sourceMap: <span class="hljs-literal">true</span>
          }
        },
        <span class="hljs-string">'postcss-loader'</span>
        {
          loader: <span class="hljs-string">'sass-loader'</span>,
          options: {
            sourceMap: <span class="hljs-literal">true</span>
          }
        }
      ]
    }
  ]
},
plugins: [
  <span class="hljs-keyword">new</span> ExtractTextPlugin(<span class="hljs-string">'styles.css'</span>)
]
</code></pre><p>That were the common issues I’ve faced while upgrading my projects build, you can find out more in official documentation. Hope my tips will save your time and reduce a headache before docs will be completely fulfilled. Write your own tips in comments.</p></section></article><div id="disqus_thread" class="mdl-card mdl-shadow--3dp mdl-cell mdl-cell--12-col comments-widget"></div></section></main><footer role="contentinfo" class="mdl-mini-footer page-footer"><a href="#top" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--primary mdl-button--fab mdl-button--mini-fab to-top js-to-top"><svg class="mdl-svg to-top__icon"><use xlink:href="#expand-less"/></svg></a><section class="mdl-mini-footer--left-section page-footer__left-section"><a href="https://twitter.com/bobrov1989" target="_blank" rel="nofollow noreferrer noopener" class="mdl-mini-footer--social-btn" title="Twitter"><svg class="mdl-mini-footer--social-btn__icon"><use xlink:href="#twitter"/></svg> </a><a href="https://github.com/vitaliy-bobrov" target="_blank" rel="nofollow noreferrer noopener" class="mdl-mini-footer--social-btn" title="GitHub"><svg class="mdl-mini-footer--social-btn__icon"><use xlink:href="#github"/></svg></a></section><section class="mdl-copyright"><p>&copy; 2017 Bobrov Blog</p></section><section class="mdl-mini-footer--right-section page-footer__right-section"><p>Generated with <a href="http://metalsmith.io/" target="_blank" rel="nofollow noreferrer noopener">Metalsmith</a></p></section></footer></div><script src="/js/main.min.js" defer></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-90372372-1', 'auto');
      ga('send', 'pageview');</script><script>var disqus_config = function() {
        this.page.url = 'https://vitaliy-bobrov.github.io/blog/webpack-2-migration-tips';
        this.page.identifier = 'webpack_2_migration_tips';
        this.page.title = 'Webpack 2 Migration Tips';
      };

      (function(d) {
        var s = d.createElement('script');
        s.src = '//bobrov-blog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })(document);</script></body></html>