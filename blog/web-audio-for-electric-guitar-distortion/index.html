<!doctype html><html lang="en"><head><title>Web Audio for Electric Guitar: Distortion | Bobrov Dev</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="Want to know how to create distortion, overdrive, and"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="alternate" href="http://localhost:3000/blog/web-audio-for-electric-guitar-distortion/" hreflang="en"><link rel="canonical" href="http://localhost:3000/blog/web-audio-for-electric-guitar-distortion/"><meta name="msapplication-tap-highlight" content="no"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="Bobrov Dev"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Bobrov Dev"><meta name="msapplication-TileColor" content="#008ba3"><link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon.png"><link rel="icon" type="image/png" href="/images/icons/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/images/icons/favicon-16x16.png" sizes="16x16"><meta name="theme-color" content="#008ba3"><link rel="manifest" href="/manifest.json"><meta name="google-site-verification" content="-49tfdke4pxwhrBhLHu5VHTk-bb7g9jK_xQuD5Elq2Y"><link rel="preload" as="script" href="https://www.googletagmanager.com/gtag/js?id=UA-90372372-1"><link rel="stylesheet" href="/css/styles.css"><meta property="fb:app_id" content="393821434298248"><meta property="article:author" content="https://www.facebook.com/bobrov1989"><meta property="og:url" content="http://localhost:3000/blog/web-audio-for-electric-guitar-distortion/"><meta property="og:type" content="article"><meta property="og:title" content="Web Audio for Electric Guitar: Distortion"><meta property="og:description" content="Want to know how to create distortion, overdrive, and"><meta property="og:image" content="http://localhost:3000/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-og.jpg"><meta property="og:image:url" content="http://localhost:3000/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-og.jpg"><meta property="og:image:type" content="image/jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": "True",
        "headline": "Web Audio for Electric Guitar: Distortion",
        "image": [
          "http://localhost:3000/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-og.jpg"
        ],
        "datePublished": "2020-01-27158008320000001:00:00+01",
        "dateModified": "2020-01-27158008320000001:00:00+01",
        "author": {
          "@type": "Person",
          "name": "Vitalii Bobrov"
        },
        "publisher": {
          "@type": "Organization",
          "name": "Bobrov Dev",
          "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:3000/images/logo.png",
            "width": "96",
            "height": "96"
          }
        },
        "description": "Want to know how to create distortion, overdrive, and"
      }</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90372372-1"></script><script>if (navigator.doNotTrack !== '1') {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-90372372-1');
      }</script><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@bobrov1989"><meta name="twitter:title" content="Web Audio for Electric Guitar: Distortion"><meta name="twitter:description" content="Want to know how to create distortion, overdrive, and"><meta name="twitter:image" content="http://localhost:3000/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-og.jpg"><meta name="twitter:image:alt" content="Web Audio for Electric Guitar: Distortion"></head><body class="mdlext-dark-color-theme mdl-layout__container"><div class="mdl-layout mdl-layout--no-desktop-drawer-button mdl-layout--fixed-header mdl-js-layout"><header class="mdl-layout__header is-casting-shadow" role="banner"><div class="mdl-layout__drawer-button" role="button" tabindex="0" aria-expanded="false"><svg class="mdl-svg drawer-icon"><use xlink:href="/images/sprite.svg#menu"/></svg> Menu</div><div class="mdl-layout__header-row"><span class="mdl-layout-title"><a class="site-link" href="http://localhost:3000/" rel="nofollow">Bobrov Dev</a></span><div class="mdl-layout-spacer"><a href="http://localhost:3000/" class="site-logo" title="Bobrov Dev" rel="nofollow"><picture class="site-logo__picture"><source media="(min-width: 1025px)" srcset="/images/logo.webp, /images/logo@2x.webp 2x" type="image/webp"><source media="(min-width: 1025px)" srcset="/images/logo.png, /images/logo@2x.png 2x"><source media="(min-width: 768px)" srcset="/images/logo-tablet.webp, /images/logo-tablet@2x.webp 2x" type="image/webp"><source media="(min-width: 768px)" srcset="/images/logo-tablet.png, /images/logo-tablet@2x.png 2x"><source srcset="/images/logo-mobile.webp, /images/logo-mobile@2x.webp 2x" type="image/webp"><source srcset="/images/logo-mobile.png, /images/logo-mobile@2x.png 2x"><img src="/images/logo.png" alt="Bobrov Dev Logo" loading="eager" class="site-logo__img"></picture></a></div><nav class="mdl-navigation mdl-layout--large-screen-only" aria-label="Main navigation"><a class="mdl-navigation__link mdl-navigation__link_active" href="http://localhost:3000/" rel="nofollow">Blog</a> <a class="mdl-navigation__link" href="http://localhost:3000/speaker/">Speaker </a><a class="mdl-navigation__link" href="http://localhost:3000/about/">About</a></nav></div></header><div class="mdl-layout__drawer"><span class="mdl-layout-title">Bobrov Dev</span><nav class="mdl-navigation" aria-label="Main navigation"><a class="mdl-navigation__link mdl-navigation__link_active" href="http://localhost:3000/" rel="nofollow" aria-current="page">Blog</a> <a class="mdl-navigation__link" href="http://localhost:3000/speaker/">Speaker </a><a class="mdl-navigation__link" href="http://localhost:3000/about/">About </a><button class="mdl-button mdl-button--raised js-add-to-home" disabled>Add to home screen</button></nav></div><div class="mdl-layout__content js-lazy-container"><main class="mdl-grid posts-grid"><article class="mdl-card mdl-shadow--3dp mdl-cell post mdl-cell--12-col"><header class="mdl-card__media post__media"><picture class="safe-picture"><source media="(min-width: 1025px)" srcset="/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion.webp, /images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion@2x.webp 2x" type="image/webp"><source media="(min-width: 1025px)" srcset="/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion.jpg, /images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion@2x.jpg 2x"><source media="(min-width: 768px)" srcset="/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-tablet.webp, /images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-tablet@2x.webp 2x" type="image/webp"><source media="(min-width: 768px)" srcset="/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-tablet.jpg, /images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-tablet@2x.jpg 2x"><source srcset="/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-mobile.webp, /images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-mobile@2x.webp 2x" type="image/webp"><source srcset="/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-mobile.jpg, /images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion-mobile@2x.jpg 2x"><img src="/images/posts/web-audio-for-electric-guitar-distortion/web-audio-for-electric-guitar-distortion.jpg" loading="eager" alt="Web Audio for Electric Guitar: Distortion" class="safe-picture__img"></picture><div class="safe-gradient"></div><h1 class="post__title">Web Audio for Electric Guitar: Distortion</h1></header><section class="post__info post-info"><div class="post-info__data"><picture class="post-info__avatar"><source srcset="/images/authors/bobrov/avatar.webp, /images/authors/bobrov/avatar@2x.webp 2x" type="image/webp"><source srcset="/images/authors/bobrov/avatar.jpg, /images/authors/bobrov/avatar@2x.jpg 2x"><img src="/images/authors/bobrov/avatar.jpg" loading="lazy" alt="Vitalii Bobrov Photo" class="mdl-list__item-avatar"></picture><div class="post-info__data-wrapper"><div class="post-info__author">Vitalii Bobrov</div><time datetime="2020-01-27" class="post-info__date">27 January 2020</time></div></div><div class="post-info__side"><div class="post-info__categories"><a href="/category/guides" class="mdl-chip post-info__category"><span class="mdl-chip__text">Guides</span> </a><a href="/category/web-audio" class="mdl-chip post-info__category"><span class="mdl-chip__text">Web Audio</span></a></div></div></section><div class="mdl-card__menu post-share"><button id="share-menu-0" class="mdl-button mdl-button--icon ripple post-share__button js-share-btn" title="Share this post" aria-label="Share this post" data-share-title="Web Audio for Electric Guitar: Distortion" data-share-text="Web Audio for Electric Guitar: Distortion by @bobrov1989" data-share-url="http://localhost:3000/blog/web-audio-for-electric-guitar-distortion/"><span class="ripple-ink"></span> <svg class="mdl-svg post-share__icon"><use xlink:href="/images/sprite.svg#share"/></svg> Share post</button><ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu share-menu js-share-menu"><li class="mdl-menu__item share-menu__item"><a href="https://www.facebook.com/sharer.php?u=http://localhost:3000/blog/web-audio-for-electric-guitar-distortion/" class="share-menu__link" target="_blank" rel="nofollow noreferrer noopener"><svg class="share-menu__icon"><use xlink:href="/images/sprite.svg#facebook"/></svg> Facebook</a></li><li class="mdl-menu__item share-menu__item"><a href="https://twitter.com/home?status=http://localhost:3000/blog/web-audio-for-electric-guitar-distortion/" class="share-menu__link" target="_blank" rel="nofollow noreferrer noopener"><svg class="share-menu__icon"><use xlink:href="/images/sprite.svg#twitter"/></svg> Twitter</a></li><li class="mdl-menu__item share-menu__item"><a href="https://linkedin.com/shareArticle?url=http://localhost:3000/blog/web-audio-for-electric-guitar-distortion/" class="share-menu__link" target="_blank" rel="nofollow noreferrer noopener"><svg class="share-menu__icon"><use xlink:href="/images/sprite.svg#linkedin"/></svg> LinkedIn</a></li></ul></div><section class="post__contents"><p>Nobody could imagine rock music without distortion effect. Overdrive and distortion stompboxes are most widely used guitar effects. Today I want to show how to implement that effect using Web Audio API &#x1F39B;!</p><p><em>This post is a part of &#x201C;Web Audio for Electric Guitar&#x201D; series, check out other posts as well!</em></p><h3 class="post__series">Web Audio for Electric Guitar Series:</h3><ol class="post__series"><li><a href="https://bobrov.dev/blog/web-audio-for-electric-guitar-how-to-connect-instrument/" target="_blank" rel="nofollow noreferrer noopener">How to Connect Instrument</a></li><li><a href="https://bobrov.dev/blog/web-audio-for-electric-guitar-cabinet-emulation/" target="_blank" rel="nofollow noreferrer noopener">Cabinet Emulation</a></li><li>Distortion &#x2013; Current</li></ol><h2>What is Distortion?</h2><p>Distortion is an audio effect that is widely used in rock music (but not only) to create heavy guitar (or bass) sounds. The sound wave get damaged going thought the effect pipeline and become saturated with new harmonics. Harmonics are additional waves summed together to get more complex wave shapes. It is a big separate topic, but you can find a lot of information about it, I could recommend to read about harmonics <a href="https://blackstoneappliances.com/dist101.html" target="_blank" rel="nofollow noreferrer noopener">here</a>. It is way easier to get the idea of distorted signal with illustration of a clean and distorted sound waves.</p><p class="js-lazy-load"><img src="/images/posts/web-audio-for-electric-guitar-distortion/img/clipping.jpg" alt="Sine vs clipped signal graph"></p><p>As you can see, the original signal gets clipped, means it&#x2019;s amplitude get cut at some threshold. The flat cut-off called hard clipping, the rounded &#x2013; soft clipping. In analog pedals and amplifiers there are a bunch of ways to get signal saturation using diodes, transistors or tubes. I won&#x2019;t cover that details here, just mention it. However doing digital versions of the old classics requires some knowledge regarding how sound wave is clipped. You can find such information on resources like <a href="https://www.electrosmash.com/boss-ds1-analysis" target="_blank" rel="nofollow noreferrer noopener">Electro Smash</a>.</p><p class="js-lazy-load"><img src="/images/posts/web-audio-for-electric-guitar-distortion/img/boss-ds1-distortion-schematic-parts.jpg" alt="Boss DS-1 schematic from https://www.electrosmash.com"></p><p>Actually distortion is not an only effect, but a group of effects - overdrive, distortion and fuzz. The main difference between them is how hard they transform the original sound. Overdrive boosts your electric guitar gain and applies soft clipping. The clipping level depends on how hard you play on instrument, plus how it get boosted before the clipping stage. Distortion heavily saturates sound and gives the same amount of the effect no matter how loud you are playing, that is called compressed. Fuzz takes distortion to the next level making wave almost square, so it sounds like if you amp is broken.</p><p class="js-lazy-load"><img src="/images/posts/web-audio-for-electric-guitar-distortion/img/overdrive-dist-fuzz-clip.jpg" alt="Comparison graphs of overdrive, distortion and fuzz clipping"></p><p>It is hard to describe a sound with words, so I put samples of each effect to get better understanding:</p><ul><li>Overdrive</li><li>Distortion</li><li>Fuzz</li></ul><p>With help of different type of distortion applied to the sound you can play a huge range of music, starting from blues and ending with heavy metal &#x1F918;. In this post we will focus on distortion, I will leave fuzz and overdrive for a separate posts.</p><h3>History</h3><p class="js-lazy-load align-left shape shape-circle"><img src="/images/posts/web-audio-for-electric-guitar-distortion/img/fuzz-face.png" alt="Dunlop Fuzz Face"></p><p>Before we will start digging into distortion internal implementation, I want to give you a introductory history of how it was invented. Back in late 1940s guitarists noticed that tube amplifier gives &#x201C;interesting&#x201D; sound when used at extreme volume levels. Tubes has it&#x2019;s voltage range to work normally, but when you pass more power though it the sound starting to clip. Even more sound will be clipped in a soft way, cleating nice sounding harmonics. So musicians started to overdrive tube amps to get such distorted sound.</p><p>In early 1950s some guitarists accidendially used amplifiers with damaged speaker. Broken speaker produced a cool buzzy sound, so musicians started to damage speakers themself to get such an effect in recordings. Only in 1960s manufactures introduced a pedals with very first fuzz effects: Maestro Fuzz-Tone, Tone Bender, Fuzz Face.</p><p class="js-lazy-load align-right shape shape-parallelogram"><img src="/images/posts/web-audio-for-electric-guitar-distortion/img/ibanez-ts808.png" alt="Ibanez TS808 Tube Screamer"></p><p>In 1970s world entered a new rock era with pedals that tried to achieve the sound of tube amp &#x2013; overdrives. At that time legendary stompboxes like Ibanez Tube Screamer and BOSS OD-1 OverDrive was introduced.</p><p>1980s started the decade of heavy metal bands. More heavier music styles required more gain than overdrive can give and more readable sound than fuzz pedal could do. Electronics had evolved a lot, so companies started production of such classic distortions as MXR Distortion+, ProCo RAT and BOSS DS-1.</p><p>With evolution of music and styles people still trying to find own &#x201C;that&#x201D; sound. Nowadays a lot of new, more versalite and heavier distortions are done, but a lot of them still based on classic ones schematics and ideas. However some effects are radically new, like Plasma by Gamechanger Audio.</p><p class="js-lazy-load clear"><img src="/images/posts/web-audio-for-electric-guitar-distortion/img/plasma-pedal.jpg" alt="Gamechanger Audio Plasma Pedal"></p><h2>Implementation ways</h2><p>It was enough history and facts about analog distortion pedals, but how we can make something similar in digital world? More specially using Web Audio. To answer that question I would like to take a look at analog effect schematic stages and pedal controls. Standard distortion stompbox has at least 3 knobs: level (could be called volume), tone (sometimes called filter), and gain. Level control could be used to control signal boost before it will be clipped. Sound with wider amplitude will be more saturated and compressed at the end. Gain control is used for amount of clipping and distortion of the signal. Tone is used to share the sound after it was distorted.</p><p class="js-lazy-load"><img src="/images/posts/web-audio-for-electric-guitar-distortion/img/distortion-controls.jpg" alt="Distortion (BOSS DS-1) controls"></p><p>In general the stages of distortion schematic consists of: input boost stage, clipping stage, and tone stage. So in digital world we can first make signal louder using <code>GainNode</code>. Optionally we can filter input signal with lowpass and highpass filters, that gives a control what frequencies will be passed to the clipping stage. The thing is that very low and very high frequiencies distortion could sound unpleasant for our ears, so it is quite common to filter them out beforehand.</p><p>Then the signal goes to the heart of the effect &#x2013; clipping stage. There are bunch of ways to do clipping in digital processing. For example we can use IIR (Infinite Response) filters to emulate op-amp or JFET clipping. Or we can use basic wave shaping of the signal using <code>WaveShaperNode</code> and precalculated look-up table of values. Or we can split signal into few frequency bands and saturate them in parallel, then combine them back into one signal. In that post we will use wave shaping as it is the easier technique to use in Web Audio.</p><p>Final and in most important part of the effect is a tone control. This stage is the place where the soul of distortion is created. Different clipping stages could sound pretty similar, however the significant difference post-filtering could do, creating unique texture of the sound. The basic tone control could be a lowpass filter with cut-off frequency controlled by a knob. More advanced pedals could have separate controls for bass, treble and middle.</p><h2>Distortion</h2><p>As we already know stages of the effect we could start to implement them one by one. The first stage is a boost, just a single <code>GainNode</code>. Usually distortion pedals increase volume more than 10 dB, let try to use +15 dB:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> boost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GainNode</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token punctuation">{</span>gain<span class="token punctuation">:</span> <span class="token function">dBToGain</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>We can use a simple utility function to convert dB to Web Audio gain value:</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">dBToGain</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> value <span class="token operator">/</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Before signal saturation lets filter it using <code>BiquadFilterNode</code>, more specially lowpass nad highpass filters. Highpass filter could be set at 200 Hz to cut bassy frequencies that could sound muddy when distorted. Lowpass could be set at 5 KHz as clipping creates a lot of new harmonics and those harmonics could have frequencies higher that original signal and sound harsh. Those frequencies could be adjusted to your taste or exposed as a controls for the user.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> preHP <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BiquadFilterNode</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;highpass&apos;</span><span class="token punctuation">,</span>
  frequency<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token constant">Q</span><span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token constant">SQRT1_2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> preHP <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BiquadFilterNode</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">&apos;lowpass&apos;</span><span class="token punctuation">,</span>
  frequency<span class="token punctuation">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
  <span class="token constant">Q</span><span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token constant">SQRT1_2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h2>Recap</h2></section></article><div class="mdl-card mdl-shadow--3dp mdl-cell mdl-cell--12-col comments-widget"><div id="commento"></div></div></main><div aria-live="assertive" aria-atomic="true" aria-relevant="text" class="mdl-snackbar mdl-js-snackbar"><div class="mdl-snackbar__text"></div><button type="button" class="mdl-snackbar__action"></button></div><footer role="contentinfo" class="mdl-mini-footer page-footer"><section class="mdl-mini-footer--left-section page-footer__left-section"><a href="https://twitter.com/bobrov1989" target="_blank" rel="nofollow noreferrer noopener" class="mdl-mini-footer--social-btn" title="Twitter"><svg class="mdl-mini-footer--social-btn__icon"><use xlink:href="/images/sprite.svg#twitter"/></svg> Follow Vitalii Bobrov on Twitter </a><a href="https://github.com/vitaliy-bobrov" target="_blank" rel="nofollow noreferrer noopener" class="mdl-mini-footer--social-btn" title="GitHub"><svg class="mdl-mini-footer--social-btn__icon"><use xlink:href="/images/sprite.svg#github"/></svg> View Vitalii Bobrov profile on GitHub</a></section><section class="mdl-copyright"><p>&copy; 2020 Bobrov Dev</p></section><section class="mdl-mini-footer--right-section page-footer__right-section"></section></footer></div><div class="mdl-layout__obfuscator"></div></div><script src="/js/main.min.js" async defer></script><script defer src="https://cdn.commento.io/js/commento.js" data-css-override="http://localhost:3000/css/commento.css"></script></body></html>